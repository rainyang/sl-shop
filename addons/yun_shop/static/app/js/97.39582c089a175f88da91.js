webpackJsonp([97],{"2klY":function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n#all .yd-cityselect {\n  bottom: 3.0625rem;\n}\n",""])},"40Vu":function(t,e,a){var i=a("6Q8E");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("64ab47f0",i,!0,{})},"4qkt":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Pexp"),o=a("Tg7E"),n={data:function(){var t=new Date;return{diyform:{},diydata:[],upload_name:"",datas:[],share_description:"",uploadUrl:"",status:0,types:{0:"diyinput",1:"diytextarea",3:"diycheckbox",4:"diyradio",5:"diyimg",2:"diyselect",7:"diydate",9:"diycity",99:"diypwd",88:"diyusername"},pickerValue:t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate(),showCity:!1,district:district,currentDateKey:"",currentCityKey:"",checks:[],isValidation:!0,activity_id:"",form_id:"",conference:{},intro:!1,thumb:"",description:"",loading:!1,goodsId:"",optionsId:"",total:""}},mounted:function(){},methods:{showIntro:function(){this.intro=!0},setCity:function(t){var e=this,a=t.itemName1+" "+t.itemName2+" "+t.itemName3;this.diydata.forEach(function(t){t.name==e.currentCityKey&&e.$set(t,"value",a)})},openPicker:function(t){this.currentDateKey=t,this.$refs.picker.open()},setDate:function(t){var e=this;this.diydata.forEach(function(a){a.name==e.currentDateKey&&e.$set(a,"value",t.Format("yyyy-MM-dd"))})},chooseUpload:function(t){return this.upload_name=t,!0},onRead_2:function(t,e){var a=this;if(!0!==e&&t.file.size>this.photosize)return this.imgPreview(t.file,3),!1;for(var i=0,n="",l=0;l<this.diydata.length;l++)if(this.upload_name==this.diydata[l].name){n=this.diydata[l].name,i=l,this.diydata[l].data.tp_max,this.diydata[l][n+"Value1"],this.diydata[l][n+"Value2"];break}var d=new FormData;if(this.diydata[i][n+"Length"]==this.diydata[i].data.tp_max||this.diydata[i][n+"Length"]>=this.diydata[i].data.tp_max)return this.$notify({background:"#fef0f0",message:"图片数量已达到上限",color:"#f56c6c"}),!1;!0===e?d.append("file",t):d.append("file",t.file),d.append("attach","upload"),o.Indicator.open(" "),axios.post(this.uploadUrl,d,{headers:{"Content-Type":"multipart/form-data"}}).then(function(l){var d=l.data;1==d.result?(a.diydata[i][n+"Length"]++,a.diydata[i][n+"Value1"].push({url:d.data.img}),!0===e?a.diydata[i][n+"Value2"].push({url:URL.createObjectURL(t)}):a.diydata[i][n+"Value2"].push({url:URL.createObjectURL(t.file)}),o.Indicator.close()):(Object(o.Toast)(d.msg),o.Indicator.close())}).catch(function(t){console.log(t),o.Indicator.close()})},removeImg_1:function(t,e){for(var a=0,i="",o=0;o<this.diydata.length;o++)if(t.name==this.diydata[o].name){i=this.diydata[o].name,a=o;break}this.diydata[a][i+"Value1"].splice(e,1),this.diydata[a][i+"Value2"].splice(e,1),this.diydata[a][i+"Length"]=this.diydata[a][i+"Value1"].length},openCity:function(t){this.currentCityKey=t},goback:function(){this.$router.go(-1)},validation:function(){var t=this;this.isValidation=!0,this.diydata.forEach(function(e){1!=e.data.tp_must||e.value||"diyimg"==e.type||(Object(o.Toast)(e.data.tp_name+"必须填写哦"),t.isValidation=!1),1==e.data.tp_must&&"diyimg"==e.type&&e[e.name+"Length"]<=0&&(t.isValidation=!1,Object(o.Toast)(e.data.tp_name+"必须填写哦")),"diycheckbox"==e.type&&0==e.value.length&&(console.log(e.data.tp_name,e.value),Object(o.Toast)(e.data.tp_name+"必须填写哦"),t.isValidation=!1)})},submit:function(){this.validation(),this.isValidation&&this.submitConference()},submitConference:function(){var t=this,e=[],a={};this.diydata.forEach(function(t){if("diyimg"==t.type){for(var e=[],i=0;i<t[t.name+"Value1"].length;i++)e.push(t[t.name+"Value1"][i].url);a[t.name]=e}else a[t.name]=t.value}),e.push(a),console.log(e),$http.post("plugin.diyform.api.diy-form.save-form-data",{form_data:e,form_id:t.form_id}).then(function(e){if(1!=e.result)return Object(o.Toast)(e.msg),void(t.goodsId?t.fun.getUrl("activityDiyForm",{id:t.form_id,goodsId:t.goodsId,optionsId:t.optionsId,total:t.total}):t.getDiyForm());Object(o.Toast)("提交成功"),t.goodsId?t.$router.push(t.fun.getUrl("goodsorder",{tag:"-2",goodsId:t.goodsId,optionsId:t.optionsId,total:t.total})):t.getDiyForm()},function(t){alert("fail")})},getDiyForm:function(){var t=this;$http.get("plugin.diyform.api.diy-form.getDiyFormTypeMemberData",{form_id:this.form_id}).then(function(e){if(1===e.result){if(t.loading=!0,1===e.data.status){t.status=e.data.status,t.diyform=e.data,t.thumb=e.data.thumb,t.share_description=e.data.share_description,t.description=e.data.description;var a=t.diyform.fields;for(var i in a){var n={title:a[i].tp_name,value:a[i].value,data_type:a[i].data_type};"3"==n.data_type&&(n.value=a[i].value.join(",")),t.datas.push(n)}return 0}t.diyform=e.data;var l=t.diyform.fields;for(var d in t.thumb=e.data.thumb,t.share_description=e.data.share_description,t.description=e.data.description,t.status=e.data.status,l){if("diycheckbox"==t.types[l[d].data_type])var s={name:d,data:l[d],value:[],type:t.types[l[d].data_type]};else if("diydate"==t.types[l[d].data_type]){if(1===(s={name:d,data:l[d],value:"",type:t.types[l[d].data_type]}).data.default_time_type){var r=new Date,c=r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate();s.value=c}else 2===s.data.default_time_type&&(s.value=s.data.default_time)}else if("diyimg"==t.types[l[d].data_type]){(s={name:d,data:l[d],value:"",type:t.types[l[d].data_type]})[d+"Length"]=0,s[d+"Value1"]=[],s[d+"Value2"]=[]}else s={name:d,data:l[d],value:"",type:t.types[l[d].data_type]};t.diydata.push(s)}}else Object(o.Toast)(e.msg)},function(t){console.log(t)})},initShare:function(){var t=this,e={url:document.location.href,i:this.fun.getKeyByI(),type:this.fun.getTyep(),mid:this.fun.getKeyByMid()};$http.post("member.member.wxJsSdkConfig",e).then(function(e){1==e.result&&e.data.config&&t.share(e.data)},function(t){console.log(t)})},share:function(t){var e=this;wx.config(t.config),wx.ready(function(){var a=e.fun.isTextEmpty(e.diyform.title)?t.shop.name:e.diyform.title,i=e.fun.isMid(document.location.href,t.info.uid),o=e.fun.isTextEmpty(e.thumb)?t.shop.icon:e.thumb,n=e.fun.isTextEmpty(e.share_description)?t.shop.name:e.share_description;wx.showOptionMenu(),wx.onMenuShareTimeline({title:a,link:i,imgUrl:o,desc:n,success:function(){}}),wx.onMenuShareAppMessage({title:a,desc:n,link:i,imgUrl:o,success:function(){}})})}},activated:function(){this.diydata=[],this.datas=[],this.form_id=this.$route.params.id,this.goodsId=this.$route.params.goodsId,this.optionsId=this.$route.params.optionsId,this.total=this.$route.params.total,this.form_id||(Object(o.Toast)("该表单不存在！"),this.$router.push(this.fun.getUrl("member"))),this.getDiyForm(),this.initShare(),this.uploadUrl=this.fun.getRealUrl("upload.uploadPic",{})},created:function(){},components:{cTitle:i.a}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],attrs:{id:"all"}},[i("c-title",{attrs:{hide:!1,text:t.diyform.title}}),t._v(" "),i("div",{staticStyle:{height:"40px"}}),t._v(" "),i("div",{attrs:{id:"member"}},[i("div",{attrs:{id:"tool"}},[t.thumb?i("dt",[i("img",{staticStyle:{width:"100%",height:"9.675rem"},attrs:{src:t.thumb}})]):t._e()]),t._v(" "),i("div",{staticStyle:{height:"0.005rem",clear:"both"}}),t._v(" "),0===t.status?i("div",{staticClass:"diyform"},[t._l(t.diydata,function(e){return["diyinput"==e.type?[i("yd-cell-group",[i("yd-cell-item",[i("span",{attrs:{slot:"left"},slot:"left"},[t._v(t._s(e.data.tp_name)+"：")]),t._v(" "),1==e.data.tp_must?i("yd-input",{attrs:{slot:"right",required:"",placeholder:e.data.placeholder},slot:"right",model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}):t._e(),t._v(" "),0==e.data.tp_must?i("yd-input",{attrs:{slot:"right",placeholder:e.data.placeholder},slot:"right",model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}):t._e()],1)],1)]:t._e(),t._v(" "),"diyusername"==e.type?[i("yd-cell-group",[i("yd-cell-item",[i("span",{attrs:{slot:"left"},slot:"left"},[t._v(t._s(e.data.tp_name)+"：")]),t._v(" "),1==e.data.tp_must?i("yd-input",{attrs:{slot:"right",required:"",placeholder:e.data.placeholder},slot:"right",model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}):t._e(),t._v(" "),0==e.data.tp_must?i("yd-input",{attrs:{slot:"right",placeholder:e.data.placeholder},slot:"right",model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}):t._e()],1)],1)]:t._e(),t._v(" "),"diypwd"==e.type?[i("yd-cell-group",[i("yd-cell-item",[i("span",{attrs:{slot:"left"},slot:"left"},[t._v(t._s(e.data.tp_name)+"：")]),t._v(" "),1==e.data.tp_must?i("yd-input",{attrs:{slot:"right",type:"password",required:"",placeholder:e.data.placeholder},slot:"right",model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}):t._e(),t._v(" "),0==e.data.tp_must?i("yd-input",{attrs:{slot:"right",type:"password",placeholder:e.data.placeholder},slot:"right",model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}):t._e()],1)],1)]:t._e(),t._v(" "),"diytextarea"==e.type?[i("yd-cell-group",{attrs:{title:e.data.tp_name}},[i("yd-cell-item",[i("yd-textarea",{attrs:{slot:"right",placeholder:e.data.placeholder,maxlength:"100"},slot:"right",model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}})],1)],1)]:t._e(),t._v(" "),"diycheckbox"==e.type?[i("yd-cell-group",{attrs:{title:e.data.tp_name}},t._l(e.data.tp_text,function(a,o){return i("yd-cell-item",{key:a,attrs:{type:"checkbox"}},[i("span",{attrs:{slot:"left"},slot:"left"},[t._v(t._s(a))]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"item.value"}],attrs:{slot:"right",type:"checkbox"},domProps:{value:a,checked:Array.isArray(e.value)?t._i(e.value,a)>-1:e.value},on:{change:function(i){var o=e.value,n=i.target,l=!!n.checked;if(Array.isArray(o)){var d=a,s=t._i(o,d);n.checked?s<0&&t.$set(e,"value",o.concat([d])):s>-1&&t.$set(e,"value",o.slice(0,s).concat(o.slice(s+1)))}else t.$set(e,"value",l)}},slot:"right"})])}),1)]:t._e(),t._v(" "),"diyselect"==e.type?[i("yd-cell-group",[i("yd-cell-item",{attrs:{arrow:"",type:"label"}},[i("span",{attrs:{slot:"left"},slot:"left"},[t._v(t._s(e.data.tp_name)+"：")]),t._v(" "),i("select",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"item.value"}],attrs:{slot:"right"},on:{change:function(a){var i=Array.prototype.filter.call(a.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.$set(e,"value",a.target.multiple?i:i[0])}},slot:"right"},[i("option",{attrs:{value:""}},[t._v("请选择"+t._s(e.data.tp_name))]),t._v(" "),t._l(e.data.tp_text,function(e){return i("option",{key:e,domProps:{value:e}},[t._v(t._s(e)+"\n                ")])})],2)])],1)]:t._e(),t._v(" "),"diyradio"==e.type?[i("yd-cell-group",{attrs:{title:e.data.tp_name}},t._l(e.data.tp_text,function(a){return i("yd-cell-item",{key:a,attrs:{type:"radio"}},[i("span",{attrs:{slot:"left"},slot:"left"},[t._v(t._s(a))]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"item.value"}],attrs:{slot:"right",type:"radio"},domProps:{value:a,checked:t._q(e.value,a)},on:{change:function(i){return t.$set(e,"value",a)}},slot:"right"})])}),1)]:t._e(),t._v(" "),"diyimg"==e.type?[i("yd-cell-group",{attrs:{title:e.data.tp_name}},[i("div",{staticClass:"clearfloat",staticStyle:{width:"100%","text-align":"left","line-height":"5rem"}},[t._l(e[e.name+"Value2"],function(a,o){return[i("div",{staticClass:"photobox",staticStyle:{float:"left","max-width":"25%"}},[i("img",{staticStyle:{"max-width":"5rem"},attrs:{src:a.url}}),t._v(" "),i("van-icon",{staticStyle:{width:"1.2rem",height:"1.2rem",position:"absolute",top:"0.1rem",right:"0.1rem",color:"red","font-weight":"900"},attrs:{name:"close"},on:{click:function(a){return t.removeImg_1(e,o)}}})],1)]}),t._v(" "),i("div",{on:{click:function(a){return t.chooseUpload(e.name)}}},[i("van-uploader",{attrs:{disabled:e[e.name+"Length"].length>=e.data.tp_max,"after-read":t.onRead_2}},[i("div",{staticStyle:{"padding-left":"1rem","padding-top":"1rem",width:"5rem",height:"5rem",border:"1px dashed #c0ccda"}},[i("img",{staticClass:"avatar",staticStyle:{"max-height":"3rem"},attrs:{src:a("/n1I")}})])])],1)],2)])]:t._e(),t._v(" "),"diycity"==e.type?[i("div",[i("yd-cell-group",[i("yd-cell-item",{attrs:{arrow:""}},[i("span",{attrs:{slot:"left"},slot:"left"},[t._v(t._s(e.data.tp_name)+"：")]),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"item.value"}],attrs:{slot:"right",type:"text",readonly:"",placeholder:e.data.tp_name},domProps:{value:e.value},on:{click:[function(e){e.stopPropagation(),t.showCity=!0},function(a){return t.openCity(e.name)}],input:function(a){a.target.composing||t.$set(e,"value",a.target.value)}},slot:"right"})])],1)],1)]:t._e(),t._v(" "),"diydate"==e.type?[i("yd-cell-group",[i("yd-cell-item",{nativeOn:{click:function(a){return t.openPicker(e.name)}}},[i("span",{attrs:{slot:"left"},slot:"left"},[t._v(t._s(e.data.tp_name))]),t._v(" "),i("span",{attrs:{slot:"right"},slot:"right"},[t._v(t._s(e.value))])])],1)]:t._e()]})],2):t._e(),t._v(" "),1===t.status?i("div",{staticClass:"diyform"},t._l(t.datas,function(e,a){return i("yd-cell-group",{key:a,attrs:{title:"1"!=e.data_type&&"5"!=e.data_type?"":e.title}},["1"!=e.data_type&&"5"!=e.data_type?i("yd-cell-item",[i("span",{attrs:{slot:"left"},slot:"left"},[t._v(t._s(e.title))]),t._v(" "),i("span",{attrs:{slot:"right"},slot:"right"},[t._v(t._s(e.value))])]):t._e(),t._v(" "),"1"==e.data_type?i("yd-cell-item",[i("yd-textarea",{attrs:{slot:"right",readonly:"readonly"},slot:"right",model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}})],1):t._e(),t._v(" "),"5"==e.data_type?i("yd-cell-item",[t._l(e.value,function(t,e){return i("template",{staticStyle:{width:"100%","text-align":"left"},slot:"right"},[i("div",{staticClass:"photobox",staticStyle:{float:"left","max-width":"25%","margin-top":".5rem"}},[i("img",{staticStyle:{"max-width":"5rem"},attrs:{src:t}})])])})],2):t._e()],1)}),1):t._e(),t._v(" "),i("mt-datetime-picker",{ref:"picker",attrs:{type:"date","year-format":"{value} 年","month-format":"{value} 月","date-format":"{value} 日"},on:{confirm:t.setDate},model:{value:t.pickerValue,callback:function(e){t.pickerValue=e},expression:"pickerValue"}}),t._v(" "),i("yd-cityselect",{attrs:{callback:t.setCity,items:t.district},model:{value:t.showCity,callback:function(e){t.showCity=e},expression:"showCity"}}),t._v(" "),i("div",{staticStyle:{height:"0.625rem",clear:"both"}}),t._v(" "),i("div",{staticStyle:{width:"90%",margin:"0 auto","padding-bottom":"1.5rem"}},[0===t.status?i("yd-button",{attrs:{size:"large",type:"primary"},nativeOn:{click:function(e){return t.submit(e)}}},[t._v("提交\n      ")]):t._e(),t._v(" "),1===t.status?i("yd-button",{attrs:{size:"large",type:"danger"}},[t._v("已提交\n      ")]):t._e()],1),t._v(" "),i("div",{staticStyle:{width:"100%",padding:".5rem .5rem 5rem .5rem","background-color":"#fff"}},[i("div",{domProps:{innerHTML:t._s(t.description)}})])],1)],1)},staticRenderFns:[]};var d=a("VU/8")(n,l,!1,function(t){a("xmYg"),a("40Vu")},"data-v-0bdd0a2a",null);e.default=d.exports},"6Q8E":function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,'\n@charset "UTF-8";\n/* @import "../assets/css/member.scss"; */\n#tool ul li[data-v-0bdd0a2a] {\n  width: 100% !important;\n  padding-left: 0.75rem !important;\n}\n.yd-cell-title[data-v-0bdd0a2a] {\n  height: 2.5rem !important;\n  line-height: 2.5rem !important;\n}\n.yd-cell-box[data-v-0bdd0a2a] {\n  margin-bottom: 0 !important;\n}\n.yd-btn-block[data-v-0bdd0a2a] {\n  margin-top: 0.1875rem;\n}\n.introTitle[data-v-0bdd0a2a] {\n  border-top: 0.0625rem solid #dedddd;\n}\n.yd-checkbox[data-v-0bdd0a2a] {\n  padding-bottom: 0.625rem;\n}\n.intro[data-v-0bdd0a2a] {\n  padding: 1.25rem;\n}\n.checkbox[data-v-0bdd0a2a] {\n  background: #fff;\n  padding-top: 0.625rem;\n  padding-bottom: 0.625rem;\n  border-bottom: 0.0625rem solid #ece9e9;\n  text-align: left;\n  padding-left: 0.75rem;\n}\n.photobox[data-v-0bdd0a2a] {\n  position: relative;\n  width: 5rem;\n  height: 5rem;\n  border: 1px dashed #c0ccda;\n  /*float: left;*/\n  margin-right: 0.2rem;\n  margin-left: 0.2rem;\n  margin-bottom: 0.2rem;\n}\n.photobox img[data-v-0bdd0a2a] {\n    width: 100%;\n    height: 100%;\n}\n/*清除浮动代码*/\n.clearfloat[data-v-0bdd0a2a]:after {\n  display: block;\n  clear: both;\n  content: "";\n  visibility: hidden;\n  height: 0;\n}\n.clearfloat[data-v-0bdd0a2a] {\n  zoom: 1;\n}\n',""])},xmYg:function(t,e,a){var i=a("2klY");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("a2b04e78",i,!0,{})}});