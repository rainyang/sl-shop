webpackJsonp([207],{gUNc:function(t,e,o){var n=o("kxFB");(t.exports=o("FZ+f")(!1)).push([t.i,"\n#edit_card[data-v-c8f5dd52] {\n  padding-top: 40px;\n  padding-bottom: 64px;\n}\n#edit_card .mint-header[data-v-c8f5dd52] {\n    background: none;\n    color: #666;\n}\n#edit_card .is-fixed .mint-header-title[data-v-c8f5dd52] {\n    font-weight: bold;\n}\n#edit_card .mint-header.is-fixed[data-v-c8f5dd52] {\n    border-bottom: 0.0625rem solid #e8e8e8;\n    background: #fff;\n    z-index: 99;\n}\n#edit_card .is-right a[data-v-c8f5dd52] {\n    font-size: 10px;\n}\n#edit_card .m-dialog1[data-v-c8f5dd52] {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    min-height: 120%;\n    z-index: 100;\n    background: #ffffff;\n}\n#edit_card .content .state_box[data-v-c8f5dd52] {\n    background: #fff;\n}\n#edit_card .content .state_box .state[data-v-c8f5dd52] {\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      height: 2.875rem;\n      line-height: 2.875rem;\n      padding: 0 0.875rem;\n      font-size: 15px;\n}\n#edit_card .content .state_box .state .left[data-v-c8f5dd52] {\n        width: 6.25rem;\n        text-align: left;\n}\n#edit_card .content .state_box .state .right .van-radio-group[data-v-c8f5dd52] {\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        height: 2.875rem;\n}\n#edit_card .content .state_box .state .right .van-radio-group .van-radio[data-v-c8f5dd52] {\n          width: 6.25rem;\n          text-align: left;\n          display: -webkit-box;\n          display: -ms-flexbox;\n          display: flex;\n          -webkit-box-align: center;\n              -ms-flex-align: center;\n                  align-items: center;\n}\n#edit_card .content .state_box .tips[data-v-c8f5dd52] {\n      line-height: 2.25rem;\n      color: #8c8c8c;\n      font-size: 14px;\n      text-align: left;\n      border-top: solid 0.0625rem #ebebeb;\n      padding-right: 0.875rem;\n      margin-left: 0.875rem;\n}\n#edit_card .content .basic_info h1[data-v-c8f5dd52] {\n    font-size: 16px;\n    line-height: 2.25rem;\n    padding: 0 0.875rem;\n    text-align: left;\n    margin-top: 0.625rem;\n    font-weight: normal;\n    color: #8c8c8c;\n}\n#edit_card .content .basic_info .info_box .header_img[data-v-c8f5dd52] {\n    width: 2.25rem;\n    height: 2.25rem;\n    border-radius: 2.25rem;\n    overflow: hidden;\n    background: #f2f2f2;\n    margin-right: 0.625rem;\n}\n#edit_card .content .basic_info .info_box .header_img .van-uploader[data-v-c8f5dd52] {\n      width: 2.25rem;\n      height: 2.25rem;\n}\n#edit_card .content .basic_info .info_box .header_img img[data-v-c8f5dd52] {\n      width: 100%;\n      height: 100%;\n}\n#edit_card .content .basic_info .info_box .iconfont[data-v-c8f5dd52] {\n    font-size: 10px;\n    color: #f15353;\n    margin-left: 0.25rem;\n}\n#edit_card .content .card_info h1[data-v-c8f5dd52] {\n    font-weight: normal;\n    color: #8c8c8c;\n    font-size: 16px;\n    line-height: 2.25rem;\n    text-align: left;\n    padding: 0 0.875rem;\n}\n#edit_card .content .card_info .my_synopsis[data-v-c8f5dd52],\n  #edit_card .content .card_info .my_voice[data-v-c8f5dd52],\n  #edit_card .content .card_info .my_img[data-v-c8f5dd52] {\n    padding: 0 1.25rem;\n    background: #fff;\n}\n#edit_card .content .card_info .my_synopsis .voice_box[data-v-c8f5dd52],\n    #edit_card .content .card_info .my_voice .voice_box[data-v-c8f5dd52],\n    #edit_card .content .card_info .my_img .voice_box[data-v-c8f5dd52] {\n      padding: 0.625rem 0;\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-align: center;\n          -ms-flex-align: center;\n              align-items: center;\n      -webkit-box-pack: center;\n          -ms-flex-pack: center;\n              justify-content: center;\n}\n#edit_card .content .card_info .my_synopsis .voice_box i[data-v-c8f5dd52],\n      #edit_card .content .card_info .my_voice .voice_box i[data-v-c8f5dd52],\n      #edit_card .content .card_info .my_img .voice_box i[data-v-c8f5dd52] {\n        font-size: 2rem;\n        color: #fff;\n}\n#edit_card .content .card_info .my_synopsis .voice_box button[data-v-c8f5dd52],\n      #edit_card .content .card_info .my_voice .voice_box button[data-v-c8f5dd52],\n      #edit_card .content .card_info .my_img .voice_box button[data-v-c8f5dd52] {\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        -webkit-box-align: center;\n            -ms-flex-align: center;\n                align-items: center;\n        -webkit-box-pack: center;\n            -ms-flex-pack: center;\n                justify-content: center;\n        border: none;\n        width: 15rem;\n        height: 2.5rem;\n        color: #fff;\n        background: #50a6f9;\n        border-radius: 0.375rem;\n        margin-left: 1.25rem;\n}\n#edit_card .content .card_info .my_synopsis .voice_box .btn_a[data-v-c8f5dd52],\n      #edit_card .content .card_info .my_voice .voice_box .btn_a[data-v-c8f5dd52],\n      #edit_card .content .card_info .my_img .voice_box .btn_a[data-v-c8f5dd52] {\n        width: 13.75rem;\n        height: 2.5rem;\n        line-height: 2.5rem;\n        border: solid 0.0625rem #ebebeb;\n        border-radius: 0.25rem;\n        color: #8c8c8c;\n        font-size: 15px;\n}\n#edit_card .content .card_info .my_synopsis h2[data-v-c8f5dd52],\n    #edit_card .content .card_info .my_voice h2[data-v-c8f5dd52],\n    #edit_card .content .card_info .my_img h2[data-v-c8f5dd52] {\n      font-size: 15px;\n      line-height: 1.875rem;\n      padding: 0.625rem 0;\n      text-align: left;\n      font-weight: normal;\n}\n#edit_card .content .card_info .my_synopsis textarea[data-v-c8f5dd52],\n    #edit_card .content .card_info .my_voice textarea[data-v-c8f5dd52],\n    #edit_card .content .card_info .my_img textarea[data-v-c8f5dd52] {\n      width: 100%;\n      max-height: 6.25rem;\n      border-radius: 0.25rem;\n      border: solid 0.0625rem #ebebeb;\n      padding: 0.625rem;\n      line-height: 1.5rem;\n      background: #fafafa;\n}\n#edit_card .content .card_info .my_synopsis .voice_btn[data-v-c8f5dd52],\n    #edit_card .content .card_info .my_voice .voice_btn[data-v-c8f5dd52],\n    #edit_card .content .card_info .my_img .voice_btn[data-v-c8f5dd52] {\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-pack: justify;\n          -ms-flex-pack: justify;\n              justify-content: space-between;\n}\n#edit_card .content .card_info .my_synopsis .voice_btn .btn_a[data-v-c8f5dd52],\n      #edit_card .content .card_info .my_voice .voice_btn .btn_a[data-v-c8f5dd52],\n      #edit_card .content .card_info .my_img .voice_btn .btn_a[data-v-c8f5dd52] {\n        width: 13.75rem;\n        height: 2.5rem;\n        line-height: 2.5rem;\n        border: solid 0.0625rem #ebebeb;\n        border-radius: 0.25rem;\n        color: #8c8c8c;\n        font-size: 15px;\n}\n#edit_card .content .card_info .my_synopsis .voice_btn .btn_b[data-v-c8f5dd52],\n      #edit_card .content .card_info .my_voice .voice_btn .btn_b[data-v-c8f5dd52],\n      #edit_card .content .card_info .my_img .voice_btn .btn_b[data-v-c8f5dd52] {\n        width: 5.625rem;\n        height: 2.5rem;\n        background: #50a6f9;\n        border: none;\n        border-radius: 0.25rem;\n        color: #fff;\n        font-size: 15px;\n}\n#edit_card .content .card_info .my_synopsis .img_uploader[data-v-c8f5dd52],\n    #edit_card .content .card_info .my_voice .img_uploader[data-v-c8f5dd52],\n    #edit_card .content .card_info .my_img .img_uploader[data-v-c8f5dd52] {\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-pack: start;\n          -ms-flex-pack: start;\n              justify-content: flex-start;\n      -ms-flex-wrap: wrap;\n          flex-wrap: wrap;\n}\n#edit_card .content .card_info .my_synopsis .img_uploader .photoBox[data-v-c8f5dd52],\n      #edit_card .content .card_info .my_voice .img_uploader .photoBox[data-v-c8f5dd52],\n      #edit_card .content .card_info .my_img .img_uploader .photoBox[data-v-c8f5dd52] {\n        position: relative;\n        width: 4.5rem;\n        height: 4.5rem;\n        border: 1px dashed #c0ccda;\n        margin-right: 0.2rem;\n        margin-left: 0.2rem;\n        margin-bottom: 0.2rem;\n}\n#edit_card .content .card_info .my_synopsis .img_uploader .photoBox img[data-v-c8f5dd52],\n        #edit_card .content .card_info .my_voice .img_uploader .photoBox img[data-v-c8f5dd52],\n        #edit_card .content .card_info .my_img .img_uploader .photoBox img[data-v-c8f5dd52] {\n          width: 100%;\n          height: 100%;\n}\n#edit_card .content .card_info .my_synopsis .img_uploader .photoBox i[data-v-c8f5dd52],\n        #edit_card .content .card_info .my_voice .img_uploader .photoBox i[data-v-c8f5dd52],\n        #edit_card .content .card_info .my_img .img_uploader .photoBox i[data-v-c8f5dd52] {\n          width: 1.2rem;\n          height: 1.2rem;\n          position: absolute;\n          top: 0.1rem;\n          right: 0.1rem;\n          background: url("+n(o("Gq6R"))+");\n          background-size: 100%;\n}\n#edit_card .content .card_info .my_synopsis .img_uploader .van-uploader[data-v-c8f5dd52],\n      #edit_card .content .card_info .my_voice .img_uploader .van-uploader[data-v-c8f5dd52],\n      #edit_card .content .card_info .my_img .img_uploader .van-uploader[data-v-c8f5dd52] {\n        width: 4.5rem;\n        height: 4.5rem;\n        overflow: hidden;\n        background: #f2f2f2;\n        margin-left: 0.2rem;\n        margin-right: 0.875rem;\n        margin-bottom: 0.9375rem;\n}\n#edit_card .content .card_info .my_synopsis .img_uploader .van-uploader .van-icon[data-v-c8f5dd52],\n        #edit_card .content .card_info .my_voice .img_uploader .van-uploader .van-icon[data-v-c8f5dd52],\n        #edit_card .content .card_info .my_img .img_uploader .van-uploader .van-icon[data-v-c8f5dd52] {\n          font-size: 24px;\n          line-height: 4.5rem;\n          color: #666;\n}\n#edit_card .content .recom_goods[data-v-c8f5dd52] {\n    background: #fff;\n    margin-top: 0.625rem;\n    padding: 0 0.9375rem;\n}\n#edit_card .content .recom_goods .title[data-v-c8f5dd52] {\n      height: 2.5rem;\n      line-height: 2.5rem;\n      display: -webkit-box;\n      display: -ms-flexbox;\n      display: flex;\n      -webkit-box-align: center;\n          -ms-flex-align: center;\n              align-items: center;\n}\n#edit_card .content .recom_goods .title .block[data-v-c8f5dd52] {\n        width: 0.25rem;\n        height: 1rem;\n        background: #50a6f9;\n        border-radius: 0.0625rem;\n        margin-right: 0.375rem;\n}\n#edit_card .content .recom_goods .title span[data-v-c8f5dd52] {\n        font-weight: bold;\n        font-size: 16px;\n}\n#edit_card .content .recom_goods .goods_list[data-v-c8f5dd52] {\n      padding-top: 0.625rem;\n}\n#edit_card .content .recom_goods .goods_list .goods_box[data-v-c8f5dd52] {\n        background: #fafafa;\n        padding: 0.625rem;\n        display: -webkit-box;\n        display: -ms-flexbox;\n        display: flex;\n        margin-bottom: 0.625rem;\n}\n#edit_card .content .recom_goods .goods_list .goods_box .goods_img[data-v-c8f5dd52] {\n          width: 5.25rem;\n          height: 5.25rem;\n          overflow: hidden;\n          margin-right: 0.625rem;\n          background: #f2f2f2;\n}\n#edit_card .content .recom_goods .goods_list .goods_box .goods_img img[data-v-c8f5dd52] {\n            width: 100%;\n            height: 100%;\n}\n#edit_card .content .recom_goods .goods_list .goods_box .goods_text[data-v-c8f5dd52] {\n          width: 14.4375rem;\n          position: relative;\n}\n#edit_card .content .recom_goods .goods_list .goods_box .goods_text .name[data-v-c8f5dd52] {\n            text-overflow: ellipsis;\n            overflow: hidden;\n            display: -webkit-box;\n            -webkit-line-clamp: 2;\n            -webkit-box-orient: vertical;\n            font-size: 15px;\n            text-align: left;\n}\n#edit_card .content .recom_goods .goods_list .goods_box .goods_text .sum[data-v-c8f5dd52] {\n            position: absolute;\n            bottom: 0;\n            display: -webkit-box;\n            display: -ms-flexbox;\n            display: flex;\n            line-height: 1.5rem;\n            width: 100%;\n            -webkit-box-pack: justify;\n                -ms-flex-pack: justify;\n                    justify-content: space-between;\n}\n#edit_card .content .recom_goods .goods_list .goods_box .goods_text .sum span[data-v-c8f5dd52] {\n              color: #f15353;\n              font-size: 16px;\n}\n#edit_card .content .recom_goods .goods_list .goods_box .goods_text .sum span font[data-v-c8f5dd52] {\n                font-size: 12px;\n}\n#edit_card .content .recom_goods .goods_list .goods_box .goods_text .sum .iconfont[data-v-c8f5dd52] {\n              font-size: 24px;\n              color: #ccc;\n}\n#edit_card .content .recom_goods .add_btn button[data-v-c8f5dd52] {\n      width: 100%;\n      margin-bottom: 0.625rem;\n      height: 2.5rem;\n      line-height: 2.5rem;\n      border: none;\n      color: #50a6f9;\n      font-size: 16px;\n}\n#edit_card .content .recom_goods .add_btn button i[data-v-c8f5dd52] {\n        color: #50a6f9;\n        font-size: 1.125rem;\n        margin-right: 0.625rem;\n}\n#edit_card .car_btm_btn[data-v-c8f5dd52] {\n    background: #fff;\n    position: fixed;\n    bottom: 0;\n    padding: 0.625rem 0.9375rem;\n    border-top: solid 0.0625rem #ebebeb;\n    width: 100%;\n}\n#edit_card .car_btm_btn button[data-v-c8f5dd52] {\n      width: 100%;\n      height: 2.5rem;\n      background: #50a6f9;\n      font-size: 16px;\n      border: none;\n      border-radius: 3.75rem;\n      color: #fff;\n}\n",""])},jzNr:function(t,e,o){var n=o("gUNc");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);o("rjj0")("75f5a568",n,!0,{})},kErt:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("fZjL"),a=o.n(n),i=o("mvHQ"),r=o.n(i),d=o("//Fk"),c=o.n(d),s=o("Pexp"),l=o("Tg7E"),f=document.createElement("canvas"),m=f.getContext("2d"),_={data:function(){return{isOldVoice:!1,card_id:"",chooseItem:[],is_allow:0,showStart:!1,localId:"",serverId:"",downLoadId:"",time:0,timer:null,playAudio:!1,district:district,form:{status:1,member_id:"",card_avatar:"",card_name:"",card_mobile:"",card_wechat:"",role_name:"",role_id:"",introduction:"",voice:"",province:"",city:"",district:"",street:"",address:"",picture:[],goods_id:[],addressName:"",streetName:""},addressShow:!1,strShow:!1,streetShow:!1,showRole:!1,columns:[],role:{},photosize:4194304,imageUrl:"",fileList2:[]}},activated:function(){this.card_id=this.$route.params.card_id,this.playAudio=!1,this.isOldVoice=!1,this.initShare(),this.getRole(),this.getData()},mounted:function(){this.amr=null;this.loadDemoBtn1=document.querySelector("#amr-load"),this.loadAmrFile1=document.querySelector("#amr-file"),this.playBtn=document.querySelector("#amr-play"),this.duration=document.querySelector("#amr-duration")},deactivated:function(){},methods:{isend:function(){this.playAudio=!1},reloadVoice:function(){this.isOldVoice=!1},end:function(t){var e=this;this.$refs.audios.src=URL.createObjectURL(t),this.$refs.audios.onended=function(){e.playAudio=!1}},playAmr:function(){this.$refs.audios.paused?(this.playAudio=!0,this.$refs.audios.play()):(this.playAudio=!1,this.$refs.audios.pause())},initWithUrl:function(t){return new c.a(function(e,o){fetch(t,{method:"GET",responseType:"blob",headers:{"Content-Type":"application/octet-stream"},credentials:"include"}).then(function(t){t.ok&&t.blob().then(function(t){console.log(t),e(t)})}).catch(function(t){o(t)})}).then(function(t){return t})},loadDemoBtn:function(t){var e=this;e.initWithUrl(t).then(function(t){Recorder.amr2wav(t,function(t){e.end(t),console.log("已转码成wav播放")},function(t){console.log("转码成wav失败："+t)})})},gotoCardCenter:function(t){var e=new RegExp("business_card/edit_card/"+this.card_id),o=window.location.href.replace(e,"business_card/card_center");t.preventDefault(),location.replace(o)},deleteGoods:function(t){for(var e=0;e<this.chooseItem.length;e++)this.chooseItem[e].id==t&&this.chooseItem.splice(e,1);window.localStorage.setItem("chooseItem",r()(this.chooseItem))},setJSONData:function(){this.form.card_id=this.card_id;for(var t=0;t<this.chooseItem.length;t++)this.form.goods_id.push(this.chooseItem[t].id);delete this.form.addressName,delete this.form.streetName,"1"!=this.form.role_id&&"2"!=this.form.role_id&&"3"!=this.form.role_id&&"6"!=this.form.role_id&&(this.form.goods_id=[])},saveData:function(t){var e=this;this.form.card_name?(this.setJSONData(),$http.post("plugin.business-card.frontend.controllers.card.card.edit",this.form).then(function(o){if(1===o.result){window.localStorage.setItem("cardData",""),window.localStorage.setItem("chooseItem","");var n=new RegExp("business_card/edit_card/"+e.card_id),a=window.location.href.replace(n,"business_card/card_center");t.preventDefault(),location.replace(a)}else Object(l.Toast)(o.msg)},function(t){console.log(t)})):Object(l.Toast)("请输入姓名")},getData:function(){var t=this;$http.post("plugin.business-card.frontend.controllers.card.card.index",{card_id:this.card_id}," ").then(function(e){if(1===e.result){var o=e.data.card;t.is_allow=e.data.is_allow,t.fun.getKey("formCard")?(window.localStorage.getItem("cardData")&&(t.form=JSON.parse(window.localStorage.getItem("cardData")),t.strShow=!t.fun.isTextEmpty(t.form.street),t.strShow&&t.getStreet(t.form.district)),window.localStorage.getItem("chooseItem")&&(t.chooseItem=JSON.parse(window.localStorage.getItem("chooseItem")))):(t.form.status=o.status,t.form.member_id=o.member_id,t.form.card_avatar=o.card_avatar,t.form.card_name=o.card_name,t.form.card_mobile=o.card_mobile,t.form.card_wechat=o.card_wechat,t.form.role_name=o.role_name,t.form.role_id=o.role_id,t.form.introduction=o.introduction,t.form.voice=o.voice,t.fun.isWeiXin()&&t.form.voice&&(t.isOldVoice=!0,t.loadDemoBtn(t.form.voice)),o.areas[0]&&(t.form.addressName=o.areas[0]+o.areas[1]+o.areas[2]),o.areas[3]&&(t.form.streetName=o.areas[3]),t.form.province=o.area_id[0],t.form.city=o.area_id[1],t.form.district=o.area_id[2],t.form.street=o.area_id[3],t.form.address=o.address,o.area_id[2]&&t.getStreet(o.area_id[2]),o.picture?t.form.picture=o.picture:t.form.picture=[],t.chooseItem=e.data.card_goods,window.localStorage.setItem("chooseItem",r()(t.chooseItem)))}else Object(l.Toast)(e.msg),t.$router.push(t.fun.getUrl("home"))},function(t){console.log(t)})},onRead:function(t,e){l.Indicator.open("上传中");var o=new FormData;!0===e?o.append("file",t):o.append("file",t.file);var n=this;axios.post(this.fun.getRealUrl("plugin.business-card.frontend.controllers.card.card.upload-local"),o,{headers:{"Content-Type":"multipart/form-data"}}).then(function(o){var a=o.data;1===a.result?(l.Indicator.close(),n.imageUrl=!0===e?URL.createObjectURL(t):URL.createObjectURL(t.file),n.form.card_avatar=a.data.img_url):(l.Indicator.close(),Object(l.Toast)(a.msg))}).catch(function(t){l.Indicator.close(),console.log(t)})},multipleMethod_1:function(t,e){if(t&&t.length)for(var o=0;o<t.length;o++)this.onRead_1(t[o],e);else this.onRead_1(t,e)},onRead_1:function(t,e){l.Indicator.open("上传中");var o=new FormData;!0===e?o.append("file",t):o.append("file",t.file);var n=this;axios.post(this.fun.getRealUrl("upload.uploadPic"),o,{headers:{"Content-Type":"multipart/form-data"}}).then(function(o){var a=o.data;1===a.result?(l.Indicator.close(),!0===e?n.fileList2.push({url:URL.createObjectURL(t)}):n.fileList2.push({url:URL.createObjectURL(t.file)}),n.form.picture.push(a.data.img_url)):(l.Indicator.close(),Object(l.Toast)(a.msg))}).catch(function(t){l.Indicator.close(),console.log(t)})},onphotosize:function(t){this.imgPreview(t.file,1)},onphotosize2:function(t){this.imgPreview(t.file,2)},imgPreview:function(t,e){var o=this;if(t&&window.FileReader&&/^image/.test(t.type)){var n=new FileReader;n.readAsDataURL(t),n.onloadend=function(){var n=this.result,a=new Image;a.src=n,a.onload=function(){var n=this.width,i=this.height,r=n,d=i;(n>400||i>400)&&(n/i>1?(r=400,d=Math.round(i/n*400)):(d=400,r=Math.round(n/i*400))),f.width=r,f.height=d,m.clearRect(0,0,r,d),m.drawImage(a,0,0,r,d),f.toBlob(function(t){1===e?o.onRead(t,!0):o.multipleMethod_1(t,!0)},t.type||"image/png")}}}},removeImg:function(t){this.form.picture.splice(t,1)},getRole:function(){var t=this;$http.post("plugin.business-card.frontend.controllers.card.card.getRoles",{card_id:this.card_id}).then(function(e){if(1===e.result){var o=[];t.role=e.data,a()(e.data).forEach(function(t){o.push(e.data[t])}),t.columns=o}},function(t){console.log(t)})},onCancel:function(){this.showRole=!1},onConfirm:function(t,e){var o=this.role,n=this;this.form.role_name=t,a()(o).forEach(function(e){if(o[e]===t)return n.form.role_id=e,e}),this.showRole=!1},streetChoose:function(){this.fun.isTextEmpty(this.form.addressName)?l.MessageBox.alert("请先选择所在地区"):this.streetShow=!0},addressCallback:function(t){this.form.street="",this.districtVal="",this.form.addressName=t.itemName1+" "+t.itemName2+" "+t.itemName3,this.form.province=t.itemValue1,this.form.city=t.itemValue2,this.form.district=t.itemValue3,this.getStreet(t.itemValue3)},streetConfirm:function(t){this.form.streetName=t.areaname,this.form.street=t.id,this.streetShow=!1},getStreet:function(t){var e=this;$http.get("member.memberAddress.street",{district_id:t}," ").then(function(t){1!==t.result||e.fun.isTextEmpty(t.data)?e.strShow=!1:!e.fun.isTextEmpty(t.data)&&t.data.length>0?(e.districtVal=t.data,e.strShow=!0):e.strShow=!1}).catch(function(t){e.strShow=!1,console.log(t)})},toChooseGood:function(){window.localStorage.setItem("cardData",r()(this.form)),this.$router.push(this.fun.getUrl("micro_shop_add_category",{},{formCard:this.card_id}))},initShare:function(){var t=this;$http.post("member.member.wxJsSdkConfig",{url:"android"===this.fun.isIosOrAndroid()?window.location.href:window.initUrl}).then(function(e){1===e.result&&e.data.config&&e.data.config&&t.share(e.data)},function(t){console.log(t)})},share:function(t){var e=this;wx.config(t.config),wx.ready(function(){var t="android"===e.fun.isIosOrAndroid()?window.location.href:window.initUrl,o=e.form.card_avatar,n=e.form.introduction;wx.showOptionMenu(),wx.onMenuShareTimeline({title:"名片",link:t,imgUrl:o,success:function(){alert("分享成功")},cancel:function(){alert("取消分享")}}),wx.onMenuShareAppMessage({title:"名片",desc:n,link:t,imgUrl:o,type:"link",dataUrl:"",success:function(){alert("分享成功")},cancel:function(){alert("取消分享")}})})},start:function(t){var e=this;e.time=0,this.showStart=!0,wx.startRecord({success:function(){Object(l.Toast)("开始录音"),e.timer=setInterval(function(){e.time++},1e3),e.vicoeEnd()},fail:function(t){alert(r()(t))},cancel:function(){alert("用户拒绝授权录音")}})},stop:function(){var t=this;this.showStart=!1,wx.stopRecord({success:function(e){Object(l.Toast)("录音已停止"),clearInterval(t.timer),t.localId=e.localId,t.upVoice()},fail:function(t){alert("暂停出错了"),console.log(t)}})},cancel:function(){wx.stopRecord({success:function(t){alert("取消录音")}})},vicoeEnd:function(){var t=this;wx.onVoiceRecordEnd({complete:function(e){alert("超过60秒停止录音"),t.localId=e.localId,clearInterval(t.timer),t.upVoice()}})},play:function(){console.log(this.localId),wx.playVoice({localId:this.localId})},pausePlay:function(){wx.pauseVoice({localId:this.localId})},upVoice:function(){var t=this;wx.uploadVoice({localId:t.localId,isShowProgressTips:1,success:function(e){t.serverId=e.serverId,l.Indicator.open("上传录音中"),axios.post(t.fun.getRealUrl("plugin.business-card.frontend.controllers.card.card.get-voice"),{media_id:e.serverId},{headers:{"Content-Type":"application/json"}}).then(function(e){l.Indicator.close();var o=e.data;1===o.result?t.form.voice=o.data:Object(l.Toast)(o.msg)}).catch(function(t){l.Indicator.close(),console.log(t)})}})},downVoice:function(){var t=this;wx.downloadVoice({serverId:t.serverId,isShowProgressTips:1,success:function(e){t.downLoadId=e.localId,console.log(e),console.log(t.downLoadId)}})}},components:{cTitle:s.a}},h={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.streetShow?t._e():n("div",{attrs:{id:"edit_card"}},[n("mt-header",{attrs:{fixed:"",title:"编辑名片"}},[n("mt-button",{attrs:{slot:"left",icon:"back"},on:{click:t.gotoCardCenter},slot:"left"})],1),t._v(" "),n("div",{staticClass:"content"},[t.is_allow?n("div",{staticClass:"state_box"},[n("ul",{staticClass:"state"},[n("li",{staticClass:"left"},[t._v("名片状态")]),t._v(" "),n("li",{staticClass:"right"},[n("van-radio-group",{model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[n("van-radio",{attrs:{name:1}},[t._v("开启")]),t._v(" "),n("van-radio",{attrs:{name:0}},[t._v("关闭")])],1)],1)]),t._v(" "),n("p",{staticClass:"tips"},[t._v("关闭后用户无法访问您的名片首页")])]):t._e(),t._v(" "),n("div",{staticClass:"basic_info"},[n("h1",[t._v("基本信息")]),t._v(" "),n("div",{staticClass:"info_box"},[n("yd-cell-group",[n("yd-cell-item",{attrs:{arrow:""}},[n("span",{attrs:{slot:"left"},slot:"left"},[t._v("头像")]),t._v(" "),n("span",{staticClass:"header_img",attrs:{slot:"right"},slot:"right"},[n("van-uploader",{attrs:{"after-read":t.onRead,"max-size":t.photosize},on:{oversize:t.onphotosize}},[t.form.card_avatar?t._e():n("img",{attrs:{src:o("Rd5w")}}),t._v(" "),t.imageUrl?n("img",{attrs:{src:t.imageUrl,alt:"头像"}}):t._e(),t._v(" "),t.form.card_avatar?n("img",{attrs:{src:t.form.card_avatar,alt:"头像"}}):t._e()])],1)]),t._v(" "),n("yd-cell-item",[n("span",{attrs:{slot:"left"},slot:"left"},[t._v("姓名"),n("i",{staticClass:"iconfont icon-info-must"})]),t._v(" "),n("yd-input",{attrs:{slot:"right",required:"","show-success-icon":!1,"show-error-icon":!1,max:"20",placeholder:"请输入姓名"},slot:"right",model:{value:t.form.card_name,callback:function(e){t.$set(t.form,"card_name",e)},expression:"form.card_name"}})],1),t._v(" "),n("yd-cell-item",[n("span",{attrs:{slot:"left"},slot:"left"},[t._v("手机号")]),t._v(" "),n("yd-input",{attrs:{slot:"right",required:"","show-success-icon":!1,"show-error-icon":!1,max:"20",placeholder:"请输入手机号"},slot:"right",model:{value:t.form.card_mobile,callback:function(e){t.$set(t.form,"card_mobile",e)},expression:"form.card_mobile"}})],1),t._v(" "),n("yd-cell-item",[n("span",{attrs:{slot:"left"},slot:"left"},[t._v("微信号")]),t._v(" "),n("yd-input",{attrs:{slot:"right",required:"","show-success-icon":!1,"show-error-icon":!1,max:"20",placeholder:"请输入微信号"},slot:"right",model:{value:t.form.card_wechat,callback:function(e){t.$set(t.form,"card_wechat",e)},expression:"form.card_wechat"}})],1),t._v(" "),n("yd-cell-item",{attrs:{arrow:""}},[n("span",{attrs:{slot:"left"},slot:"left"},[t._v("角色选择：")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.form.role_name,expression:"form.role_name"}],attrs:{slot:"right",type:"text",readonly:"",placeholder:"角色选择"},domProps:{value:t.form.role_name},on:{click:function(e){e.stopPropagation(),t.showRole=!0},input:function(e){e.target.composing||t.$set(t.form,"role_name",e.target.value)}},slot:"right"})]),t._v(" "),n("yd-cell-group",[n("yd-cell-item",{attrs:{arrow:""}},[n("span",{attrs:{slot:"left"},slot:"left"},[t._v("所在城市")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.form.addressName,expression:"form.addressName"}],attrs:{slot:"right",type:"text",readonly:"",placeholder:"请选择收货地址"},domProps:{value:t.form.addressName},on:{click:function(e){e.stopPropagation(),t.addressShow=!0},input:function(e){e.target.composing||t.$set(t.form,"addressName",e.target.value)}},slot:"right"})]),t._v(" "),t.strShow?n("yd-cell-item",{attrs:{arrow:""}},[n("span",{attrs:{slot:"left"},slot:"left"},[t._v("街道：")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.form.streetName,expression:"form.streetName"}],attrs:{slot:"right",type:"text",readonly:"",placeholder:"请选择街道"},domProps:{value:t.form.streetName},on:{click:function(e){return e.stopPropagation(),t.streetChoose(e)},input:function(e){e.target.composing||t.$set(t.form,"streetName",e.target.value)}},slot:"right"})]):t._e()],1),t._v(" "),n("yd-cell-item",[n("span",{attrs:{slot:"left"},slot:"left"},[t._v("详细地址")]),t._v(" "),n("yd-input",{attrs:{slot:"right",required:"","show-success-icon":!1,"show-error-icon":!1,max:"20",placeholder:"请输入详细地址"},slot:"right",model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}})],1)],1)],1)]),t._v(" "),n("div",{staticClass:"card_info"},[n("h1",[t._v("名片设置")]),t._v(" "),n("div",{staticClass:"my_synopsis"},[n("h2",[t._v("我的简介")]),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.introduction,expression:"form.introduction"}],attrs:{placeholder:"请输入简介"},domProps:{value:t.form.introduction},on:{input:function(e){e.target.composing||t.$set(t.form,"introduction",e.target.value)}}})]),t._v(" "),t.fun.isWeiXin()?n("div",{staticClass:"my_voice"},[n("h2",[t._v("我的声音")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.isOldVoice,expression:"isOldVoice"}],staticClass:"voice_box"},[n("button",{attrs:{type:"button"},on:{click:t.playAmr}},[n("i",{staticClass:"iconfont icon-card_voice"}),t._v(t._s(t.playAudio?"暂停":"点击播放已有录音")+"\n            ")]),t._v(" "),n("button",{staticClass:"btn_a",staticStyle:{background:"#fff",color:"#3b4043"},on:{click:t.reloadVoice}},[t._v("重新录音")]),t._v(" "),n("p",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}]},[n("audio",{ref:"audios",attrs:{controls:"",onended:t.isend}})])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.isOldVoice,expression:"!isOldVoice"}],staticClass:"voice_btn"},[n("div",{staticClass:"btn_a",on:{click:t.play}},[t._v("录音时间"+t._s(t.time)),n("span",{directives:[{name:"show",rawName:"v-show",value:t.form.voice,expression:"form.voice"}]},[t._v("（点击播放）")])]),t._v(" "),t.showStart?t._e():n("button",{staticClass:"btn_b",attrs:{type:"button"},on:{click:t.start}},[t._v("\n              开始录音\n            ")]),t._v(" "),t.showStart?n("button",{staticClass:"btn_b",attrs:{type:"button"},on:{click:t.stop}},[t._v("\n              停止录音\n            ")]):t._e()])]):t._e(),t._v(" "),n("div",{staticClass:"my_img"},[n("h2",[t._v("我的图片")]),t._v(" "),n("div",{staticClass:"img_uploader"},[t._l(t.form.picture,function(e,o){return[n("div",{staticClass:"photoBox"},[n("img",{staticStyle:{width:"100%"},attrs:{src:e}}),t._v(" "),n("i",{on:{click:function(e){return t.removeImg(o)}}})])]}),t._v(" "),n("van-uploader",{attrs:{"after-read":t.multipleMethod_1,"max-size":t.photosize,multiple:""},on:{oversize:t.onphotosize2}},[n("van-icon",{attrs:{name:"photograph"}})],1)],2)])]),t._v(" "),"1"==t.form.role_id||"2"==t.form.role_id||"3"==t.form.role_id||"6"==t.form.role_id?n("div",{staticClass:"recom_goods"},[t._m(0),t._v(" "),n("div",{staticClass:"goods_list"},[t._l(t.chooseItem,function(e,o){return n("div",{key:o,staticClass:"goods_box"},[n("div",{staticClass:"goods_img"},[n("img",{attrs:{src:e.thumb}})]),t._v(" "),n("ul",{staticClass:"goods_text"},[n("li",{staticClass:"name",staticStyle:{"-webkit-box-orient":"vertical"}},[t._v("\n                "+t._s(t._f("escapeTitle")(e.title))+"\n              ")]),t._v(" "),n("li",{staticClass:"sum"},[n("span",[n("font",[t._v("¥")]),t._v(t._s(e.price)+"\n                ")],1),t._v(" "),n("i",{staticClass:"iconfont icon-delete",on:{click:function(o){return t.deleteGoods(e.id)}}})])])])}),t._v(" "),t.chooseItem.length<=0?n("div",{staticClass:"goods_box"},[n("span",{staticStyle:{width:"100%","text-align":"center"}},[t._v("暂无商品~")])]):t._e()],2),t._v(" "),n("div",{staticClass:"add_btn"},[n("button",{attrs:{type:"button"},on:{click:t.toChooseGood}},[n("i",{staticClass:"iconfont icon-life-game-plus"}),t._v("添加商品\n          ")])])]):t._e()]),t._v(" "),n("div",{staticClass:"car_btm_btn",style:{width:3==this.fun.getPhoneEnv()?"375px":"100%"}},[n("button",{attrs:{type:"button"},on:{click:t.saveData}},[t._v("保存")])])],1),t._v(" "),n("van-popup",{attrs:{position:"bottom"},model:{value:t.showRole,callback:function(e){t.showRole=e},expression:"showRole"}},[n("van-picker",{attrs:{"show-toolbar":"",columns:t.columns},on:{cancel:t.onCancel,confirm:t.onConfirm}})],1),t._v(" "),n("yd-cityselect",{attrs:{callback:t.addressCallback,items:t.district},model:{value:t.addressShow,callback:function(e){t.addressShow=e},expression:"addressShow"}}),t._v(" "),n("transition",{attrs:{name:"move"}},[t.streetShow?n("div",{staticClass:"m-dialog1",staticStyle:{background:"#ffffff"}},[n("yd-navbar",{attrs:{title:"选择街道",height:"2.5rem",fontsize:"14px",fixed:""}},[n("span",{attrs:{slot:"left"},slot:"left"},[n("yd-navbar-back-icon",{nativeOn:{click:function(e){t.streetShow=!1}}})],1)]),t._v(" "),n("div",{staticStyle:{clear:"both","margin-top":"2.5rem"}}),t._v(" "),t._l(t.districtVal,function(e,o){return n("yd-cell-item",{key:o,nativeOn:{click:function(o){return t.streetConfirm(e)}}},[n("span",{attrs:{slot:"left"},slot:"left"},[t._v(t._s(e.areaname))])])})],2):t._e()])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title"},[e("div",{staticClass:"block"}),this._v(" "),e("span",[this._v("推荐商品")])])}]};var u=o("VU/8")(_,h,!1,function(t){o("jzNr")},"data-v-c8f5dd52",null);e.default=u.exports}});